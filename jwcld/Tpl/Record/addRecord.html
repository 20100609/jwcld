<include file="./jwcld/tpl/headertemp.html" />
<section id='content'>
    <div class='container-fluid'>
    <div class='row-fluid' id='content-wrapper'>
    <div class='span12'>
    <div class='row-fluid'>
        <div class='span12'>
            <div class='page-header'>
                <h1 class='pull-left'>
                    <i class='icon-table'></i>
                    <span>听课记录在线表单填写</span>
                </h1>
                <div class='span4 pull-right'>
                    <form id="form1" class="form-horizontal" method="post" action="{:U('Record/addRecord',array('cid'=>$data_course['cid']))}">
                        <div class="control-group">
                            <label class="control-label" for="inputTopic"><strong>听课记录表类型</strong></label>
                            <div class="controls">
                                <select class='select2 input-block-level' name="tktype" id="selYt">
                                    <option value='-1' selected="selected"/>------请选择------
                                    <option value="1">领导干部听课记录表</option>
                                    <option value="2">本科教学观摩课听课记录表</option>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    
<div class='row-fluid'>
    <div class='span12 box bordered-box green-border' style='margin-bottom:0;'>
        <div class='box-header green-background'>
            <div class='text-center'>北京师范大学领导干部听课记录表（2016版）</div>
        </div>
        <div class=''>
        <form id='form2' accept-charset="utf-8" class="form form-horizontal" method="post" style="margin-bottom: 0;">
            <div class='responsive-table' id="no-more-tables">
                <div class='scrollable-area'>
                    <table class='table table-bordered table-hover table-striped' style='margin-bottom:0;'>
                        <tr>
                            <th>课程名称</th>
                            <td colspan="12">
                                <input class='span12' id='full-name' type='text' disabled="disabled" name='cname' value='{$data_course.cname}' />
                            </td>
                        </tr>
                        <tr>
                            <th>教师姓名</th>
                            <td>
                                <input class='span12' id='full-name' type='text' disabled="disabled" name='tname' value='{$data_course.tname}' />
                            </td>
                            <th >单位</th>
                            <td colspan="2">
                                <!--<textarea class="form-control" rows="2" disabled="disabled">生命科学与技术学院</textarea>-->
                                <input class='span12' id='full-name' type='text' disabled="disabled" name='tcollege' value='{$data_course.tcollege}' />
                            </td>
                            <th>职称</th>
                            <td colspan="5">
                                <input class='span12' id='full-name' type='text' disabled="disabled" name='title' value='{$data_course.title}' />
                            </td>
                        </tr>
                        <tr>
                            <th rowspan="2">授课对象·</th>
                            <td rowspan="2" colspan="7">
                                <input class='span12' style="height:100%" type='text' disabled="disabled" name='sc' value='{$data_course.sclass}'/>
                            </td>
                            <th style="width: 70px;">选课人数</th>
                            <td colspan="5">
                                <input class='span12' id='full-name' type='text' disabled="disabled" name='yingdao' value='{$data_course.yingdao}'/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 70px;">实到人数</th>
                            <td colspan="5">
                                <input class='span12' id='full-name' type='text' name='shidao'/>
                            </td>
                        </tr>
                        <tr>
                            <th>培养层次</th>
                            <td colspan="12">
                                <div class="form-group">
                                    <!--label for="name">文本框</label-->
                                   <if condition="$data_course['pycc'] eq '1'">
                                    <!--label for="name">文本框</label-->
                                    <label class="radio inline">
                                        <input id='' type='radio' value='1' name='pycc'  checked="checked" disabled="disabled"/>&nbsp;&nbsp;本科
                                    </label>
                                    <else />
                                    <label class="radio inline">
                                        <input id='' type='radio' value='1' disabled="disabled" name='pycc' / >&nbsp;&nbsp;本科
                                    </label>
                                    </if>
                                    <if condition="$data_course['pycc'] eq '2'">
                                    <label class="radio inline">
                                        <input id='' type='radio' value='2' disabled="disabled" name='pycc' / checked="checked">&nbsp;&nbsp;研究生
                                    </label>
                                    <else />
                                    <label class="radio inline">
                                        <input id='' type='radio' value='2' disabled="disabled" name='pycc' />&nbsp;&nbsp;研究生
                                    </label>
                                    </if>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th>听课时间<font color="red" size="4px">*</font></th>
                            <td colspan="1" style="width: 190px;">
                                <div class='datepicker input-append' id='datepicker'>
                                    <input class='input-medium' data-format='yyyy-MM-dd' type='text' name='tktime' required />
                                    <span class='add-on'>
                                        <i data-date-icon='icon-calendar' data-time-icon='icon-time'></i>
                                    </span>
                                </div>
                            </td>
                            <th>听课地点</th>
                            <td colspan="3">
                                <input class='span12' id='full-name' type='text' disabled="disabled" name='cplase' value='{$data_course.cplace}' />
                            </td>
                            <th>听课节数<font color="red" size="4px">*</font></th>
                            <td colspan="3">
                                <input class='span12' type='number' name='tkjs' placeholder="听课的总节数(如2,3等)" required />
                            </td>
                        </tr>   
                        <tr>
                            <th style="width: 95px;">课程教学章节及主要内容<font color="red" size="4px">*</font></th>
                            <td colspan="9">
                                <div class="form-group">
                                    <textarea class="form-control" rows="2" style="margin-left: 0px; margin-right: 0px; width: 99%;" name="content"></textarea>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th>对课程教学的评价与建议<font color="red" size="4px">*</font></th>
                            <td colspan="9">
                                <div class="form-group">
                                    <textarea class="form-control" rows="5" style="margin-left: 0px; margin-right: 0px; width: 99%;" name="pjjy" placeholder="教学态度、教学方法或教学内容设计等的优点，不足及进一步改进的建议"></textarea>
                                </div>
                            </td>
                        </tr> 
                        <tr>
                            <th>对学生学习情况的评价与建议<font color="red" size="4px">*</font></th>
                            <td colspan="9">
                                <div class="form-group">
                                    <textarea class="form-control" rows="5" style="margin-left: 0px; margin-right: 0px; width: 99%;" name="xsjy" placeholder="包括教学中学生的参与程度，学生出勤等情况以及需要改进的方面" required></textarea>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th>对本次课程教学的总体评价<font color="red" size="4px">*</font></th>
                            <td colspan="9">
                                <div class="form-group">
                                    <!--label for="name">文本框</label-->
                                    <label class="radio inline">
                                        <input id='' type='radio' value='1' name='ztpj' required/>&nbsp;&nbsp;好
                                    </label>
                                    <label class="radio inline">
                                        <input id='' type='radio' value='2' name='ztpj' required />&nbsp;&nbsp;较好
                                    </label>
                                    <label class="radio inline">
                                        <input id='' type='radio' value='3' name='ztpj' required />&nbsp;&nbsp;一般
                                    </label>
                                    <label class="radio inline">
                                        <input id='' type='radio' value='4' name='ztpj' required />&nbsp;&nbsp;较差
                                    </label>
                                    <label class="radio inline">
                                        <input id='' type='radio' value='5' name='ztpj' required />&nbsp;&nbsp;差
                                    </label>
                                    <label class="radio inline">
                                        <input id='' type='radio' value='6' name='ztpj' required checked="checked" />&nbsp;&nbsp;未评价
                                    </label>
                                </div>
                            </td>
                        </tr> 
                        <tr>
                            <th>师生反映的情况</th>
                            <td colspan="9">
                                <div class="form-group">
                                    <!--label for="name">文本框</label-->
                                    <textarea class="form-control" rows="2" style="margin-left: 0px; margin-right: 0px; width: 99%;" name="ssqk"></textarea>
                                </div>
                            </td>
                        </tr>                                
                    </table>
                    <input type='hidden' name='cid' value='{$data_course.cid}'>
                    <input type='hidden' name='rtype' value='1'>
                    <button type="button" class='btn btn-success' save='1' style='margin-right:20px'><i class='icon-save'></i>提交</button>
                    <button type="button" class='btn btn-success' save='0' style='margin-right:20px'><i class='icon-save'></i>保存</button>
                    <a class="btn" href="{:u('Record/record')}">取消</a>
                    <div class="error">注：如未填写完毕，可选择“保存”；如填写完毕，可选择“提交”（提交时需填写所有必填信息）；如需修改，请进“查看听课记录”中修改。</div>
                </div>
                </div>
            </form>
        </div>
    </div>
</div>
</div>
</div>
</div>
</div>
<div class='modal hide fade' id='friend_info' role='dialog' tabindex='-1'>
    <div class='modal-header'>
       <button class='close' data-dismiss='modal' type='button'>&times;</button>
        <h3><strong>请注意</strong></h3>
    </div> 
    <div class='modal-body'>
        <p style="margin-top: 10px; font-size: 16px;">
            您上次听该门课程的听课时间是<span style="color: #CE2E2E;">{$tktime}</span>。<br /><br />
            (1):&nbsp;若无需填写，请点击<span style="color: #CE2E2E;">返回</span>按钮;<br /><br />
            (2):&nbsp;如继续填写，请点击<span style="color: #CE2E2E;">填写</span>按钮;
        </p>
        <p style="margin-top: 30px;">
            <strong><span id="message" style="color: #ff0000; font-size: 16px;"></span></strong>
        </p>
    </div>
    <div class='modal-footer'>
        <div id="data_close">
            <a class="btn" href="{:U('Record/record')}">返回</a>
            <button class='btn' data-dismiss='modal'>填写</button>
        </div>
    </div>
</div>
</section>

<script type="text/javascript">
    $(document).ready(function(){
        $("#dialog").dialog({
            autoOpen:false,
            buttons:{
            关闭:function(){
                location.href="{:U('Record/record')}";
            }
        }
        });
        $("#form2").validate({
                    rules:{
                        shidao:{
                            required:true
                        },
                        pjjy:{
                            required:true
                        },
                        xsjy:{
                            required:true
                        },
                        tkjs:{
                            required:true
                        },
                        tktime:{
                            required:true
                        },
                        pycc:{
                            required:true
                        },
                        content:{
                            required:true
                        },
                    },
                    messages:{
                        shidao:{
                            required:"请填写"
                        },
                        pjjy:{
                            required:"请填写"
                        },
                        xsjy:{
                            required:"请填写"
                        },
                        tkjs:{
                            required:"请填写"
                        },
                        tktime:{
                            required:"请填写"
                        },
                        pycc:{
                            required:"请选择培养层次"
                        },
                        content:{
                            required:"请填写"
                        },
                    },
                    errorPlacement: function(error, element){
                        if (element.is(':radio') || element.is(':checkbox')) { 
                            var eid = element.attr('name'); 
                            error.appendTo(element.parent().next());
                    } else {
                    error.insertAfter(element);
                    }
                    }
        });
        $(".btn-success").click(function(){
            var $save = $(this).attr('save');
            if($save == 1){
                 if($("#form2").valid()){
                        var $d=$("#form2").serialize();
                        $d = $d + "&save=" + $save;
                        $.ajax({
                            type: 'post',
                            url: "{:U('Record/record_add_save')}",
                            data: $d ,
                            success: function(data) {
                                $("#dialog").html(data.info);
                                $("#dialog").dialog('open');
                            }
                        });            
            }
        }
            else{
                var $d=$("#form2").serialize(); //保存的情况
                $d = $d + "&save=" + $save;
                $.ajax({
                    type: 'post',
                    url: "{:U('Record/record_add_save')}",
                    data: $d ,
                    success: function(data) {
                            $("#dialog").html(data.info);
                            $("#dialog").dialog('open');
                    }
                });
            }
        });
        <if condition="$tktime neq NULL">
            $('#friend_info').modal({backdrop: 'static', keyboard: false});
        </if>
        $('#selYt').change(function(){
            $('#form1').submit();
        });
    });
</script>

<div id="dialog" title="信息" >
</div>

<include file="./jwcld/tpl/footertemp.html" />